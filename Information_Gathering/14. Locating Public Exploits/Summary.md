# Content

- [Content](#content)
  - [A Word of Caution](#a-word-of-caution)
  - [Searching for Exploits](#searching-for-exploits)
    - [Online Exploit Resources](#online-exploit-resources)
      - [The Exploit Database](#the-exploit-database)
      - [National Vulnerability Database (NVD)](#national-vulnerability-database-nvd)
      - [Packet Storm](#packet-storm)
      - [Google Search Operators](#google-search-operators)
        - [The way to work](#the-way-to-work)
        - [Demo](#demo)
    - [Offline Exploit Resources](#offline-exploit-resources)
      - [SearchSploit](#searchsploit)
        - [The way to work](#the-way-to-work-1)
        - [Demo](#demo-1)
      - [Nmap NSE Scripts](#nmap-nse-scripts)
        - [The way to work](#the-way-to-work-2)
        - [Demo](#demo-2)
      - [The Browser Exploitation Framework (BeEF)](#the-browser-exploitation-framework-beef)
        - [The way to work](#the-way-to-work-3)
        - [Demo](#demo-3)
      - [The Metasploit Framework](#the-metasploit-framework)
        - [The way to work](#the-way-to-work-4)
        - [Demo](#demo-4)

  
## A Word of Caution

- **Never** run an exploit against a target system without first verifying that the exploit is safe to use.
- It is important to understand that by downloading and running public exploits, we can greatly endanger any system that runs that code.
- Example, a tool name 0pen0wn - was published as a remote exploit for SSH. The tool was actually a Trojan horse that would install a backdoor on the victim system.
- When we exploit the source code, we get a hex-encode array name jmpcode. 
- Then i use python to decode it and get the shellcode.
  ```cpp
  char jmpcode[] =
  "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
  "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
  ```
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/1.png)

## Searching for Exploits

### Online Exploit Resources

#### The Exploit Database

- The Exploit Database (EDB) is a repository of exploit tools, malware and information related to security vulnerabilities in software. This information is gathered from a variety of sources, including vulnerability articles, versions of faulty software, and the exploit tools used to exploit these vulnerabilities.
- When a new vulnerability is discovered, security researchers can search the EDB to look at the exploits and malware that have been developed for that vulnerability. This helps them better understand the attacks that can be used to exploit the vulnerability, and they can use this information to develop new security measures to deal with the vulnerability.
- In addition, EDB also provides information on security patches and vulnerability workarounds, helping developers and security professionals to update and improve the security of their systems and systems. their application.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/2.png)

#### National Vulnerability Database (NVD)

- The National Vulnerability Database (NVD) is a free database of the US Bureau of Standards and Technology (NIST). It provides information about security vulnerabilities identified in software products, including enterprise products and consumer products. This information provides security professionals, system administrators, and software developers with an important resource to help them identify and remediate security holes in their systems.
- NVD also provides an API to access its data, allowing users to retrieve information about security vulnerabilities using automated applications or tools.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/3.png)

#### Packet Storm

- Packet Storm Security is a website that specializes in information about security and security vulnerabilities. It was founded in 1998 and has become one of the key resources in the security community. This website provides information on the latest security vulnerabilities, security analysis tools, and security theses and articles.
- Packet Storm also provides a number of other security services such as penetration testing, security monitoring, and security consulting. In addition, the site has catalogs containing thousands of exploits, scripts and other security tools to help users perform test attacks and develop security solutions for their systems.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/4.png)

#### Google Search Operators

##### The way to work

- We can use traditional search engines like Google to look for security holes and exploits being hosted on different websites. By using specific keywords and search operators such as "site:", "inurl", "intext" and "intitle", you can refine your search results to find specific information. specific security in its applications and systems. However, the use of such search engines does not guarantee that you will find all security holes and exploits related to your software product, so you should always stay up to date. and follow reputable security sources to protect your system.

##### Demo 

  ![Picture](../14.%20Locating%20Public%20Exploits/Image/5.png)
  - By using the "firefox --search" command in the Kali Linux command line environment, users can launch the Firefox browser and perform a search directly from the command line. 
  - In this example, the search statement is "Microsoft Edge site:exploit-db.com", which will search all Microsoft Edge related information on the Exploit Database website using the "site: ". The search results will be displayed on the Firefox browser when the command is executed.

### Offline Exploit Resources

- Access to the Internet is not always guaranteed during a penetration test.
- So we can use some offline tools in Kali Linux to search for exploits and security vulnerabilities.

#### SearchSploit

##### The way to work 

- This is a database of exploits and vulnerability patches discovered in software and systems worldwide. 
- Exploit Database is managed by Offensive Security, a company specializing in security research and training. The information and tools provided by Exploit Database help security professionals, software developers, and information security professionals to address vulnerabilities.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/6.png)
- The command updates the local copy of the Exploit Database archive under 
/usr/share/exploitdb/. This directory is split in two major sections, exploits and shellcodes.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/7.png)
  - The exploits folder in exploitdb contains exploit code files classified by the respective operating system, architecture and programming language. 
  - Specifically, subfolders like ```aix, android, bsd, freebsd, atheos, beos``` contain exploit code files designed to attack security holes on their respective operating systems and platforms. 
  - Subfolders like ```arm, bsd_x86, freebsd_x86``` contain exploit code files designed to attack security holes on their respective computer architectures. 
  - Finally, subdirectories like ```ashx, asp, aspx, cfm, cgi``` contain exploit code files designed to attack security holes in their respective web programming languages using extensions corresponding file.

##### Demo

- By using searchsploit, users can search for vulnerabilities in the Exploit Database more easily than manually searching, especially when the number of vulnerabilities in the data warehouse is large very big.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/8.png)
- Exemple
  - We can search for all available remote exploits that target the SMB service on the 
Windows operating system with the following syntax.
  ```searchsploit remote smb microsoft windows```
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/9.png)

#### Nmap NSE Scripts

##### The way to work

- Nmap NSE Scripts is a feature of the Nmap network scanning tool that allows users to run scripts to find security holes on the network. When running NSE Scripts, Nmap combines Nmap commands and options with pre-written or self-made scripts to perform network scanning tasks.
- When running NSE Scripts, Nmap uses different libraries and software to perform different scanning jobs. 
- NSE Scripts provides users with a wide variety of pre-written scripts, which can be used directly or edited to suit their needs. In addition, users can also write their own scripts to find security holes in their network.

##### Demo

  ![Picture](../14.%20Locating%20Public%20Exploits/Image/10.png)
- This snippet is the result returned when running the command nmap.
- --script-help=clamav-exec.nse in the command line interface. It provides information about the Nmap clamav-exec.nse script, including description, directory, links to documentation, and details of vulnerabilities exploited by the script.
- Explain about script.
  - This is a script used in the network vulnerability scanner Nmap to check if the server running ClamAV antivirus has been attacked by known vulnerabilities.
  - This script uses the TCP protocol to connect to the ClamAV server and makes a few requests such as checking the ClamAV version running on the server, checking if the server is running "scan-only" mode, and the scene. notify users of known ClamAV vulnerabilities.
  - If the script detects a vulnerability in ClamAV, it will output a warning message about that vulnerability, allowing administrators to deploy protections to reduce the risk.
  - However, keep in mind that this script can only check for known ClamAV vulnerabilities, and cannot detect new vulnerabilities or various malicious attacks.

#### The Browser Exploitation Framework (BeEF)

##### The way to work

- BeEF is a browser exploitation framework written in Ruby and JavaScript. It allows attackers to take control of the victim's web browsers using known vulnerabilities or other intrusion techniques. BeEF can be used to carry out phishing, keylogging, privilege escalation and many other web browser related attacks.
- BeEF works by inserting a JavaScript code into the websites the victim visits. This JavaScript code will connect to the BeEF server to notify the attacker that a computer has been infected.
- After a victim visits a website containing BeEF's JavaScript code, an attacker can use BeEF's graphical web console to execute attacks on the victim's browser. This console allows attackers to perform tasks such as taking screenshots, gathering login information, inserting JavaScript code to perform further attacks, and even taking full control. victim's browser.

##### Demo

- Once we are logged in, we will need to hook a victim browser. Since advanced hooking is outside the scope of this particular module, we will just use the demo page provided by the framework by clicking the highlighted demo page link. This will allow BeEF to hook our browser.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/12.png)
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/13.png)
- It gives me a sample page that I can use to hook my browser. I will copy the URL and paste it into my browser. Once I do that, I will be hooked and I can see my browser in the BeEF console.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/14.png)
- After I have hooked my browser, I can now use the BeEF console to list all the module or anything in the victim machine.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/15.png)

#### The Metasploit Framework

##### The way to work

- The Metasploit Framework is a penetration testing and exploitation platform developed by Rapid7. It allows cybersecurity professionals to examine systems, applications, and devices for security holes and check their safety.
- The Metasploit Framework works on built-in exploit modules to attack the target. These modules include exploit techniques, payload, auxiliary, and post-exploitation.
- Each module in The Metasploit Framework provides some unique skills to be able to attack different vulnerabilities on target systems. For example, some exploit modules can exploit vulnerabilities that exist on a certain web application or operating system to perform attacks.

##### Demo

- Usage of this framework is covered in-depth in a different module so we will simply focus on listing the exploits available within the framework with the search command.
- To demonstrate, consider this search for the popular MS08_067377 vulnerability.
  ![Picture](../14.%20Locating%20Public%20Exploits/Image/11.png)